"use strict";(self.webpackChunkdocs_website=self.webpackChunkdocs_website||[]).push([[7827],{3905:(e,n,a)=>{a.d(n,{Zo:()=>d,kt:()=>b});var t=a(7294);function r(e,n,a){return n in e?Object.defineProperty(e,n,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[n]=a,e}function o(e,n){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),a.push.apply(a,t)}return a}function s(e){for(var n=1;n<arguments.length;n++){var a=null!=arguments[n]?arguments[n]:{};n%2?o(Object(a),!0).forEach((function(n){r(e,n,a[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(a,n))}))}return e}function i(e,n){if(null==e)return{};var a,t,r=function(e,n){if(null==e)return{};var a,t,r={},o=Object.keys(e);for(t=0;t<o.length;t++)a=o[t],n.indexOf(a)>=0||(r[a]=e[a]);return r}(e,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(t=0;t<o.length;t++)a=o[t],n.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var l=t.createContext({}),c=function(e){var n=t.useContext(l),a=n;return e&&(a="function"==typeof e?e(n):s(s({},n),e)),a},d=function(e){var n=c(e.components);return t.createElement(l.Provider,{value:n},e.children)},u="mdxType",p={inlineCode:"code",wrapper:function(e){var n=e.children;return t.createElement(t.Fragment,{},n)}},m=t.forwardRef((function(e,n){var a=e.components,r=e.mdxType,o=e.originalType,l=e.parentName,d=i(e,["components","mdxType","originalType","parentName"]),u=c(a),m=r,b=u["".concat(l,".").concat(m)]||u[m]||p[m]||o;return a?t.createElement(b,s(s({ref:n},d),{},{components:a})):t.createElement(b,s({ref:n},d))}));function b(e,n){var a=arguments,r=n&&n.mdxType;if("string"==typeof e||r){var o=a.length,s=new Array(o);s[0]=m;var i={};for(var l in n)hasOwnProperty.call(n,l)&&(i[l]=n[l]);i.originalType=e,i[u]="string"==typeof e?e:r,s[1]=i;for(var c=2;c<o;c++)s[c]=a[c];return t.createElement.apply(null,s)}return t.createElement.apply(null,a)}m.displayName="MDXCreateElement"},5726:(e,n,a)=>{a.r(n),a.d(n,{assets:()=>l,contentTitle:()=>s,default:()=>p,frontMatter:()=>o,metadata:()=>i,toc:()=>c});var t=a(7462),r=(a(7294),a(3905));const o={sidebar_label:"Dia Randomness Oracle",sidebar_position:2},s="Dia Randomness Oracle",i={unversionedId:"examples/oracle/dia-randomness-oracle",id:"examples/oracle/dia-randomness-oracle",title:"Dia Randomness Oracle",description:"Randomness in blockchain",source:"@site/docs/examples/oracle/dia-randomness-oracle.md",sourceDirName:"examples/oracle",slug:"/examples/oracle/dia-randomness-oracle",permalink:"/docs/examples/oracle/dia-randomness-oracle",draft:!1,editUrl:"https://github.com/gear-tech/wiki/edit/master/docs/examples/oracle/dia-randomness-oracle.md",tags:[],version:"current",sidebarPosition:2,frontMatter:{sidebar_label:"Dia Randomness Oracle",sidebar_position:2},sidebar:"docs",previous:{title:"Gear Oracle",permalink:"/docs/examples/oracle/gear-oracle"},next:{title:"Decentralized DNS",permalink:"/docs/examples/dein"}},l={},c=[{value:"Randomness in blockchain",id:"randomness-in-blockchain",level:2},{value:"State",id:"state",level:2},{value:"Actions",id:"actions",level:2},{value:"Events",id:"events",level:2},{value:"Init configuration",id:"init-configuration",level:2},{value:"Conclusion",id:"conclusion",level:2}],d={toc:c},u="wrapper";function p(e){let{components:n,...a}=e;return(0,r.kt)(u,(0,t.Z)({},d,a,{components:n,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"dia-randomness-oracle"},"Dia Randomness Oracle"),(0,r.kt)("h2",{id:"randomness-in-blockchain"},"Randomness in blockchain"),(0,r.kt)("p",null,"Randomness in blockchains is important for a fair and unpredictable distribution of validator responsibilities. Computers are bad at random numbers because they are deterministic devices (the same input always produces the same output). What people usually call random numbers on a computer (such as in a gaming application), are pseudo-random - that is, they depend on a sufficiently random seed provided by the user or another type of oracle, like a weather station for atmospheric noise, your heart rate, or even lava lamps, from which it can generate a series of seemingly-random numbers. But given the same seed, the same sequence will always be generated."),(0,r.kt)("p",null,'However, there are distributed systems that try to solve the problem of "predictability" of randomness, one of them is ',(0,r.kt)("a",{parentName:"p",href:"https://drand.love/"},"drand"),"."),(0,r.kt)("p",null,"The given dia-oracle implementation is an example of a safe randomization."),(0,r.kt)("h2",{id:"state"},"State"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-rust"},"/// Used to represent high and low parts of unsigned 256-bit integer.\npub type RandomSeed = (u128, u128);\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-rust"},"#[derive(Debug, Clone, Encode, Decode, TypeInfo)]\npub struct Random {\n    pub randomness: RandomSeed,\n    pub signature: String,\n    pub prev_signature: String,\n}\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-rust"},"#[derive(Debug, Default, Clone, Encode, Decode, TypeInfo)]\npub struct RandomnessOracle {\n    pub owner: ActorId,\n    pub values: BTreeMap<u128, Random>,\n    pub last_round: u128,\n    pub manager: ActorId,\n}\n")),(0,r.kt)("h2",{id:"actions"},"Actions"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-rust"},"#[derive(Debug, Encode, Decode, TypeInfo)]\npub enum Action {\n    SetRandomValue { round: u128, value: state::Random },\n    GetLastRoundWithRandomValue,\n    UpdateManager(ActorId),\n}\n")),(0,r.kt)("h2",{id:"events"},"Events"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-rust"},"#[derive(Debug, Encode, Decode, TypeInfo)]\npub enum Event {\n    NewManager(ActorId),\n    NewRandomValue {\n        round: u128,\n        value: state::Random,\n    },\n    LastRoundWithRandomValue {\n        round: u128,\n        random_value: state::RandomSeed,\n    },\n}\n")),(0,r.kt)("h2",{id:"init-configuration"},"Init configuration"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-rust"},"#[derive(Debug, Encode, Decode, TypeInfo)]\npub struct InitConfig {\n    pub manager: ActorId,\n}\n")),(0,r.kt)("h2",{id:"conclusion"},"Conclusion"),(0,r.kt)("p",null,"A source code of the contract example provided by Gear is available on GitHub: ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/gear-dapps/oracle/blob/wip/randomness-oracle/src/lib.rs"},"oracle/randomness-oracle/src/lib.rs"),"."),(0,r.kt)("p",null,"See also an example of the smart contract testing implementation based on ",(0,r.kt)("inlineCode",{parentName:"p"},"gtest"),": ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/gear-dapps/oracle/blob/wip/randomness-oracle/tests/randomness_oracle.rs"},"oracle/randomness-oracle/tests/randomness_oracle.rs"),"."),(0,r.kt)("p",null,"For more details about testing smart contracts written on Gear, refer to this article: ",(0,r.kt)("a",{parentName:"p",href:"/docs/developing-contracts/testing"},"Program Testing"),"."))}p.isMDXComponent=!0}}]);